(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[0],{217:function(e,t,a){},278:function(e,t,a){e.exports=a(527)},509:function(e,t,a){},527:function(e,t,a){"use strict";a.r(t);var n=a(18),r=a(19),o=a(21),l=a(20),s=a(272),c=a(0),i=a.n(c),u=a(7),m=a.n(u);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var d=a(25),p=a(83),h={loggedIn:!0,loginFailed:!1,token:localStorage.getItem("token")||"",email:localStorage.getItem("email")||"",username:localStorage.getItem("username")||""};var f=a(15),g={photos:[],isUpdating:!1};var b={collections:{},dates:[],uploadDates:[],isUpdating:!1};var v={addCollectionModalVisable:!1,uploadModalVisable:!1,imageSize:"4"};var E={stats:{},profile:{},gallery:{},isUpdating:!1};var y=Object(p.c)({UserReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_SUCCESS":return console.log("UDPATING USER SETTINGS"),{loggingIn:!0,token:t.token,username:t.username,email:t.email,loginFailed:!1};case"LOGOUT_SUCCESS":return{auth:!1,loginFailed:!1};case"LOGOUT_FAILED":return{auth:!1,loginFailed:!0};default:return e}},CollectionsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"COLLECTIONS_FETCHING":return Object(f.a)({},e,{isUpdating:!0});case"COLLECTIONS_RECEIVED":return Object(f.a)({},e,{isUpdating:!1,collections:t.collections,dates:t.dates,uploadDates:t.uploadDates});default:return e}},PhotoReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PHOTO_FETCHING":return Object(f.a)({},e,{isUpdating:!0});case"PHOTO_RECEIVED":return Object(f.a)({},e,{isUpdating:!1,photos:t.photos});default:return e}},GalleryReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ADD_MODAL":return Object(f.a)({},e,{addCollectionModalVisable:!0});case"HIDE_ADD_MODAL":return Object(f.a)({},e,{addCollectionModalVisable:!1});case"SHOW_UPLOAD_MODAL":return Object(f.a)({},e,{uploadModalVisable:!0});case"HIDE_UPLOAD_MODAL":return Object(f.a)({},e,{uploadModalVisable:!1});case"CHANGE_IMAGE_SIZE":return Object(f.a)({},e,{imageSize:t.size});default:return e}},SettingsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STATS_FETCHING":return Object(f.a)({},e,{isUpdating:!0});case"STATS_UPDATED":return Object(f.a)({},e,{isUpdating:!1,stats:t.stats});case"PROFILE_UPDATED":return Object(f.a)({},e,{isUpdating:!1,profile:t.profile});case"GALLERY_UPDATED":return Object(f.a)({},e,{isUpdating:!1,gallery:t.gallery});default:return e}}}),C=a(249),O=a(250),S=a(45),k=Object(S.a)({basename:"/dashboard"}),w={baseUrl:"/api/admin",imageUrl:"/img/"},j=Object(O.createLogger)();function I(e){for(var t=0,a=Object.keys(e);t<a.length;t++){var n=a[t];e[n].title=e[n].name,e[n].value=e[n].id,I(e[n].children),e[n].children=Object.values(e[n].children)}}function D(e,t){I(e);var a=Object.values(e);(t=t.split("-")).shift();var n={children:a};return t.forEach((function(e){n=n.children[parseInt(e)]})),n}var A=a(76),T=(a(287),a(251)),P=a(31),R=a.n(P),F={login:function(e,t){return console.log("login: ",e),function(a){var n={username:e,password:t};console.log("dispathc: ",e),R.a.post(w.baseUrl+"/login",n).then((function(e){console.log(e.data),e.data.token?(localStorage.setItem("token",e.data.token),localStorage.setItem("email",e.data.email),localStorage.setItem("username",e.data.username),a(x(e.data)),console.log("push history "),k.push("/")):a(U())})).catch((function(e){a({type:"LOGOUT_FAILED"})}))}},reauth:function(){return function(e){R.a.get(w.baseUrl+"/authorised",W()).then((function(e){e.data.token&&(localStorage.setItem("token",e.data.token),localStorage.setItem("email",e.data.email),localStorage.setItem("username",e.data.username))})).catch((function(t){console.log("Error in response"),console.log(t),e(U())}))}},logout:U,update:function(e){return function(t){R.a.post(w.baseUrl+"/auth/update",e,W()).then((function(e){localStorage.setItem("email",e.data.email),localStorage.setItem("username",e.data.username),t(x(e.data))})).catch((function(e){console.log("Error in response"),console.log(e)}))}}};function U(){return function(e){localStorage.removeItem("email"),localStorage.removeItem("token"),localStorage.removeItem("username"),e({type:"LOGOUT_SUCCESS",auth:!1,email:"",token:""}),k.push("/")}}function x(e){return{type:"LOGIN_SUCCESS",email:e.email,username:e.username,token:e.token}}var L={getAll:N,edit:function(e){return function(t){t({type:"PHOTO_FETCHING"}),R.a.post(w.baseUrl+"/photo/"+e.id,e,W()).then((function(e){q("success","Photo edited successfully"),t(N(e.data))})).catch((function(e){q("warning","Error from server: "+e)}))}}};function N(){return function(e){e({type:"PHOTO_FETCHING"}),R.a.get(w.baseUrl+"/photos",W()).then((function(t){console.log(t.data),e({type:"PHOTO_RECEIVED",photos:t.data})})).catch((function(e){q("warning","Error from server: "+e)}))}}var _=a(87),M={getAll:G,create:function(e){return function(t){R.a.post(w.baseUrl+"/collection",e,W()).then((function(e){t(G()),q("success","Collections created successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}},move:function(e){return function(t){R.a.post(w.baseUrl+"/collection/move",e,W()).then((function(e){t(L.getAll()),q("success","Photo deleted successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}},remove:function(e){return function(t){R.a.delete(w.baseUrl+"/photo/"+e,W()).then((function(e){t(L.getAll()),q("success","Collections moved successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}},upload:function(e){return function(t){R.a.post(w.baseUrl+"/collection/upload",e,W()).then((function(e){t(L.getAll()),q("success","Collections uploaded successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}},update:function(e){return function(t){R.a.post(w.baseUrl+"/collection/"+e.id,e,W()).then((function(e){t(G()),q("success","Collections updated successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}}};function G(){return function(e){e({type:"COLLECTION_FETCHING"}),R.a.get(w.baseUrl+"/collections",W()).then((function(t){var a;console.log(t.data),e({type:"COLLECTIONS_RECEIVED",collections:(a=t.data).albums,dates:Object(_.a)(a.dates),uploadDates:Object(_.a)(a.uploadDates)})})).catch((function(e){q("warning","Error from server: "+e)}))}}var V={showAdd:function(){return{type:"SHOW_ADD_MODAL"}},hideAdd:function(){return{type:"HIDE_ADD_MODAL"}},showUpload:function(){return{type:"SHOW_UPLOAD_MODAL"}},hideUpload:function(){return{type:"HIDE_UPLOAD_MODAL"}},changeImageSize:function(e){return{type:"CHANGE_IMAGE_SIZE",size:e}}};var H={stats:B,all:function(){return function(e){e(B()),e((function(e){R.a.get(w.baseUrl+"/settings/gallery",W()).then((function(t){e(z(t.data))})).catch((function(e){q("warning","Error from server: "+e)}))})),e((function(e){R.a.get(w.baseUrl+"/settings/profile",W()).then((function(t){e(Y(t.data))})).catch((function(e){q("warning","Error from server: "+e)}))}))}},setProfile:function(e){return function(t){R.a.post(w.baseUrl+"/settings/profile",e,W()).then((function(e){t(Y(e.data)),q("success","Profile edited successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}},setGallery:function(e){return function(t){R.a.post(w.baseUrl+"/settings/gallery",e,W()).then((function(e){t(z(e.data)),q("success","Gallery edited successfully")})).catch((function(e){q("warning","Error from server: "+e)}))}}};function B(){return function(e){R.a.get(w.baseUrl+"/settings/stats",W()).then((function(t){e(function(e){return{type:"STATS_UPDATED",stats:e}}(t.data))})).catch((function(e){q("warning","Error from server: "+e)}))}}function Y(e){return{type:"PROFILE_UPDATED",profile:e}}function z(e){return{type:"GALLERY_UPDATED",gallery:e}}var K={purge:function(){return function(e){R.a.get(w.baseUrl+"/tasks/purge",W()).then((function(e){q("success","Rescan task started")})).catch((function(e){q("warning","Error from server: "+e)}))}},clear:function(){return function(e){R.a.get(w.baseUrl+"/tasks/clear",W()).then((function(e){q("success","Clear task started")})).catch((function(e){q("warning","Error from server: "+e)}))}},backup:function(){return function(e){R.a.get(w.baseUrl+"/tasks/backup",W()).then((function(e){!function(e,t,a){var n=document.createElement("a"),r=new Blob([JSON.stringify(e,null,2)],{type:a});n.href=URL.createObjectURL(r),n.download=t,n.click()}(e.data,"galleryBackup.txt","text/plain")})).catch((function(e){q("warning","Error from server: "+e)}))}}};function W(){if(localStorage.getItem("token"))return{headers:{Authorization:localStorage.getItem("token")}}}function q(e,t){var a="";switch(e){case"warning":a="Oh dear something went wong!";break;default:a="Completed successfully"}T.a[e]({message:a,description:t,duration:5})}a(344);var J=a(106),Z=(a(96),a(40)),Q=(a(97),a(30)),$=(a(70),a(4)),X=(a(215),a(150)),ee=(a(216),a(46)),te=(a(129),a(41)),ae=a(253),ne=a.n(ae),re=(a(217),a(58)),oe=a.n(re),le=(a(130),a(73)),se=(a(61),a(24)),ce=(a(63),a(8)),ie=(a(131),a(66)),ue=(a(358),a(191)),me=ue.a.Panel,de=te.a.Sider,pe=ie.a.Option,he={meta:{},exif:{}},fe=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).timer=null,r.handleChange=function(e){clearTimeout(r.timer);var t="checkbox"===e.target.type?e.target.checked:e.target.value,a=Object(f.a)({},r.state.data);a[e.target.name]=t,r.setState({data:a}),r.timer=setTimeout((function(){return r.triggerChange(a)}),2e3)},r.triggerChange=function(e){console.log("CHANGFE TRIGGERED"),r.props.dispatch(L.edit(e))},r.handleKeyDown=function(e){13===e.keyCode&&(clearTimeout(r.timer),r.triggerChange(r.state.data))},r.handleVisablityChange=function(e){var t=Object(f.a)({},r.state.data);t.meta.visibility=e,r.setState({data:t}),r.triggerChange(t)},r.handleCollectionChange=function(e){console.log(e);var t=Object(f.a)({},r.state.data);t.album=e,r.setState({data:t}),r.triggerChange(t)},r.state={data:he},r}return Object(r.a)(a,[{key:"componentWillReceiveProps",value:function(e){void 0!==e.data?e.data!==this.state.data&&(void 0===e.data.meta?this.setState({data:he}):this.setState({data:e.data})):this.setState({data:he})}},{key:"render",value:function(){var e={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},t=300;function a(e){return oe()(e,"YYYY-MM-DD'T'HH:mm:SSZ").format("DD-MM-YYYY HH:mm A")}void 0===this.state.data.name&&(t=0),I(this.props.collections);var n=Object.values(this.props.collections);return i.a.createElement(de,{width:t,style:{overflow:"auto",height:"calc(100vh - 64px)"}},i.a.createElement("img",{src:w.imageUrl+this.state.data.id+"?size=tiny&token="+localStorage.getItem("token"),width:"100%",alt:"thumbnail"}),i.a.createElement(ce.a,e,i.a.createElement(ue.a,{bordered:!1,defaultActiveKey:["1","2","3"]},i.a.createElement(me,{header:"Properties",key:"1"},i.a.createElement(ce.a.Item,{label:"id"},this.state.data.id),i.a.createElement(ce.a.Item,{label:"Title"},i.a.createElement(se.a,{value:this.state.data.name,name:"name",onChange:this.handleChange,onKeyDown:this.handleKeyDown})),i.a.createElement(ce.a.Item,{label:"Caption"},i.a.createElement(se.a,{value:this.state.data.caption,name:"caption",onChange:this.handleChange,onKeyDown:this.handleKeyDown})),i.a.createElement(ce.a.Item,{label:"Collection"},i.a.createElement(le.a,{value:this.state.data.album,treeData:n,placeholder:"Select Collection",onChange:this.handleCollectionChange}))),i.a.createElement(me,{header:"Visability",key:"2"},i.a.createElement(ce.a.Item,{label:"Access",hasFeedback:!0},i.a.createElement(ie.a,{placeholder:"Please select a country",value:this.state.data.meta.visibility,name:"visibility",onChange:this.handleVisablityChange},i.a.createElement(pe,{value:"PUBLIC"},"PUBLIC"),i.a.createElement(pe,{value:"HIDDEN"},"HIDDEN"),i.a.createElement(pe,{value:"PRIVATE"},"PRIVATE"))),i.a.createElement(ce.a.Item,{label:"link"},i.a.createElement("a",{href:"/photo/"+this.state.data.id},this.state.data.name," "))),i.a.createElement(me,{header:"History",key:"3"},i.a.createElement(ce.a.Item,{label:"Captured"},a(this.state.data.exif.DateTaken)),i.a.createElement(ce.a.Item,{label:"Uploaded"},a(this.state.data.meta.DateAdded)),i.a.createElement(ce.a.Item,{label:"Modified"},a(this.state.data.meta.DateModified))))))}}]),a}(i.a.PureComponent),ge=Object(d.b)((function(e){var t=e.PhotoReducer.photos,a=e.CollectionsReducer.dates,n=e.CollectionsReducer.uploadDates;return{photos:t,dates:a,collections:e.CollectionsReducer.collections,uploadDates:n}}))(fe),be=(a(62),a(29)),ve=(a(138),a(65)),Ee=ve.a.confirm,ye=be.a.Group,Ce=ce.a.create({name:"form_in_modal"})(function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).normFile=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,r=e.form.getFieldDecorator;I(this.props.collections);var o=Object.values(this.props.collections);return i.a.createElement(ve.a,{visible:t,title:"Move photos to collections",okText:"Move Photos",onCancel:a,onOk:n},i.a.createElement(ce.a,{layout:"vertical"},i.a.createElement(ce.a.Item,{label:"Choose collection",hasFeedback:!0},r("album",{rules:[{required:!0,message:"Please select the collection to upload photos to!"}]})(i.a.createElement(le.a,{treeData:o,placeholder:"Select Collection",onChange:this.handleCollectionChange})))))}}]),a}(i.a.Component)),Oe=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).handleCancel=function(){e.setState({visible:!1})},e.handleCreate=function(){var t=e.formRef.props.form;t.validateFields((function(a,n){a||(n.photos=e.props.selectedPhotos,t.resetFields(),console.log("Received values of form: ",n),e.props.dispatch(M.move(n)),e.setState({visible:!1}))}))},e.saveFormRef=function(t){e.formRef=t},e.showModal=function(){e.setState({visible:!0})},e.state={visible:!1},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(ye,{style:{float:"left"}},i.a.createElement(be.a,{onClick:this.showModal},i.a.createElement($.a,{type:"container"}),"move"),i.a.createElement(be.a,{onClick:function(){Ee({title:"Are you sure delete these photos?",content:"",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){e.props.selectedPhotos.forEach((function(t){e.props.dispatch(M.remove(t.id))})),console.log("OK")},onCancel:function(){console.log("Cancel")}})}},i.a.createElement($.a,{type:"delete"}),"delete")),i.a.createElement(Ce,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate,collections:this.props.collections}))}}]),a}(i.a.Component),Se=Object(d.b)((function(e){var t=e.PhotoReducer.photos,a=e.CollectionsReducer.dates,n=e.CollectionsReducer.uploadDates;return{photos:t,dates:a,collections:e.CollectionsReducer.collections,uploadDates:n}}))(Oe),ke=(a(447),a(262)),we=a(99),je=te.a.Header,Ie=ee.a.SubMenu,De=se.a.Search,Ae=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).logout=function(){e.props.dispatch(F.logout())},e.search=function(t){e.props.search({key:t.target.value})},e}return Object(r.a)(a,[{key:"render",value:function(){var e,t=this.props.auth.email||"test@test.com";return console.log(this.props.location),i.a.createElement(je,{className:"header",style:{padding:0}},i.a.createElement(we.a,{to:"/"},i.a.createElement("div",{className:"brand"},"GoGallery")),"/"===this.props.location.pathname&&i.a.createElement(De,{placeholder:"Filter Photos",onChange:this.search,style:{width:"400px"}}),i.a.createElement(ee.a,{theme:"dark",mode:"horizontal",selectable:!0,style:{marginTop:8,float:"right"}},i.a.createElement(Ie,{title:i.a.createElement(ke.a,{shape:"square",src:(e=50,e=e||80,"https://www.gravatar.com/avatar/"+function(e){function t(e,t){return e<<t|e>>>32-t}function a(e,t){var a,n,r,o,l;return r=2147483648&e,o=2147483648&t,l=(1073741823&e)+(1073741823&t),(a=1073741824&e)&(n=1073741824&t)?2147483648^l^r^o:a|n?1073741824&l?3221225472^l^r^o:1073741824^l^r^o:l^r^o}function n(e,n,r,o,l,s,c){return e=a(e,a(a(function(e,t,a){return e&t|~e&a}(n,r,o),l),c)),a(t(e,s),n)}function r(e,n,r,o,l,s,c){return e=a(e,a(a(function(e,t,a){return e&a|t&~a}(n,r,o),l),c)),a(t(e,s),n)}function o(e,n,r,o,l,s,c){return e=a(e,a(a(function(e,t,a){return e^t^a}(n,r,o),l),c)),a(t(e,s),n)}function l(e,n,r,o,l,s,c){return e=a(e,a(a(function(e,t,a){return t^(e|~a)}(n,r,o),l),c)),a(t(e,s),n)}function s(e){var t,a="",n="";for(t=0;t<=3;t++)a+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return a}var c,i,u,m,d,p,h,f,g,b;for(c=function(e){for(var t,a=e.length,n=a+8,r=16*((n-n%64)/64+1),o=Array(r-1),l=0,s=0;s<a;)l=s%4*8,o[t=(s-s%4)/4]=o[t]|e.charCodeAt(s)<<l,s++;return l=s%4*8,o[t=(s-s%4)/4]=o[t]|128<<l,o[r-2]=a<<3,o[r-1]=a>>>29,o}(e=function(e){e=e.replace(/rn/g,"n");for(var t="",a=0;a<e.length;a++){var n=e.charCodeAt(a);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)),h=1732584193,f=4023233417,g=2562383102,b=271733878,i=0;i<c.length;i+=16)u=h,m=f,d=g,p=b,h=n(h,f,g,b,c[i+0],7,3614090360),b=n(b,h,f,g,c[i+1],12,3905402710),g=n(g,b,h,f,c[i+2],17,606105819),f=n(f,g,b,h,c[i+3],22,3250441966),h=n(h,f,g,b,c[i+4],7,4118548399),b=n(b,h,f,g,c[i+5],12,1200080426),g=n(g,b,h,f,c[i+6],17,2821735955),f=n(f,g,b,h,c[i+7],22,4249261313),h=n(h,f,g,b,c[i+8],7,1770035416),b=n(b,h,f,g,c[i+9],12,2336552879),g=n(g,b,h,f,c[i+10],17,4294925233),f=n(f,g,b,h,c[i+11],22,2304563134),h=n(h,f,g,b,c[i+12],7,1804603682),b=n(b,h,f,g,c[i+13],12,4254626195),g=n(g,b,h,f,c[i+14],17,2792965006),h=r(h,f=n(f,g,b,h,c[i+15],22,1236535329),g,b,c[i+1],5,4129170786),b=r(b,h,f,g,c[i+6],9,3225465664),g=r(g,b,h,f,c[i+11],14,643717713),f=r(f,g,b,h,c[i+0],20,3921069994),h=r(h,f,g,b,c[i+5],5,3593408605),b=r(b,h,f,g,c[i+10],9,38016083),g=r(g,b,h,f,c[i+15],14,3634488961),f=r(f,g,b,h,c[i+4],20,3889429448),h=r(h,f,g,b,c[i+9],5,568446438),b=r(b,h,f,g,c[i+14],9,3275163606),g=r(g,b,h,f,c[i+3],14,4107603335),f=r(f,g,b,h,c[i+8],20,1163531501),h=r(h,f,g,b,c[i+13],5,2850285829),b=r(b,h,f,g,c[i+2],9,4243563512),g=r(g,b,h,f,c[i+7],14,1735328473),h=o(h,f=r(f,g,b,h,c[i+12],20,2368359562),g,b,c[i+5],4,4294588738),b=o(b,h,f,g,c[i+8],11,2272392833),g=o(g,b,h,f,c[i+11],16,1839030562),f=o(f,g,b,h,c[i+14],23,4259657740),h=o(h,f,g,b,c[i+1],4,2763975236),b=o(b,h,f,g,c[i+4],11,1272893353),g=o(g,b,h,f,c[i+7],16,4139469664),f=o(f,g,b,h,c[i+10],23,3200236656),h=o(h,f,g,b,c[i+13],4,681279174),b=o(b,h,f,g,c[i+0],11,3936430074),g=o(g,b,h,f,c[i+3],16,3572445317),f=o(f,g,b,h,c[i+6],23,76029189),h=o(h,f,g,b,c[i+9],4,3654602809),b=o(b,h,f,g,c[i+12],11,3873151461),g=o(g,b,h,f,c[i+15],16,530742520),h=l(h,f=o(f,g,b,h,c[i+2],23,3299628645),g,b,c[i+0],6,4096336452),b=l(b,h,f,g,c[i+7],10,1126891415),g=l(g,b,h,f,c[i+14],15,2878612391),f=l(f,g,b,h,c[i+5],21,4237533241),h=l(h,f,g,b,c[i+12],6,1700485571),b=l(b,h,f,g,c[i+3],10,2399980690),g=l(g,b,h,f,c[i+10],15,4293915773),f=l(f,g,b,h,c[i+1],21,2240044497),h=l(h,f,g,b,c[i+8],6,1873313359),b=l(b,h,f,g,c[i+15],10,4264355552),g=l(g,b,h,f,c[i+6],15,2734768916),f=l(f,g,b,h,c[i+13],21,1309151649),h=l(h,f,g,b,c[i+4],6,4149444226),b=l(b,h,f,g,c[i+11],10,3174756917),g=l(g,b,h,f,c[i+2],15,718787259),f=l(f,g,b,h,c[i+9],21,3951481745),h=a(h,u),f=a(f,m),g=a(g,d),b=a(b,p);return(s(h)+s(f)+s(g)+s(b)).toLowerCase()}(t)+".jpg?s="+e),style:{marginTop:0}}),style:{padding:"0px 0px"}},i.a.createElement(ee.a.Item,{key:"setting:1",onClick:this.logout},i.a.createElement($.a,{type:"logout"}),"Logout"),i.a.createElement(ee.a.Item,{key:"setting:3"},i.a.createElement(we.a,{to:"/settings"},i.a.createElement($.a,{type:"setting"}),"Settings")))))}}]),a}(i.a.PureComponent),Te=Object(A.f)(Object(d.b)((function(e){return{auth:e.UserReducer}}))(Ae)),Pe=ce.a.create({name:"form_in_modal"})(function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,r=e.form.getFieldDecorator;I(this.props.collections);var o=Object.values(this.props.collections);return i.a.createElement(ve.a,{visible:t,title:"Create a new collection",okText:"Create",onCancel:a,onOk:n},i.a.createElement(ce.a,{layout:"vertical"},i.a.createElement(ce.a.Item,{label:"Choose collection",hasFeedback:!0},r("id",{rules:[{required:!0,message:"Please select the collection to upload photos to!"}]})(i.a.createElement(le.a,{treeData:o,placeholder:"Select Collection",onChange:this.enableUpload}))),i.a.createElement(ce.a.Item,{label:"Collection Name"},r("name",{rules:[{required:!0,message:"Please input the name of collection!"}]})(i.a.createElement(se.a,null)))))}}]),a}(i.a.Component)),Re=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleCancel=function(){e.props.dispatch(V.hideAdd())},e.handleCreate=function(){var t=e.formRef.props.form;t.validateFields((function(a,n){a||(console.log("Received values of form: ",n),t.resetFields(),e.props.dispatch(M.create(n)),e.props.dispatch(V.hideAdd()))}))},e.saveFormRef=function(t){e.formRef=t},e}return Object(r.a)(a,[{key:"render",value:function(){return i.a.createElement(Pe,{wrappedComponentRef:this.saveFormRef,visible:this.props.addCollectionModalVisable,onCancel:this.handleCancel,onCreate:this.handleCreate,collections:this.props.collections})}}]),a}(i.a.Component),Fe=Object(d.b)((function(e){return{addCollectionModalVisable:e.GalleryReducer.addCollectionModalVisable,collections:e.CollectionsReducer.collections}}))(Re),Ue=(a(247),a(149)),xe=ce.a.create({name:"form_in_modal"})(function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).normFile=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},e.enableUpload=function(t){e.setState({enableUpload:!0,collection:t})},e.customRequest=function(e){var t=new FormData;t.append("file",e.file);var a=W();a.headers["content-type"]="multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s",R.a.post(e.action,t,a).then((function(t){e.onSuccess(t.data,e.file)})).catch((function(e){console.log(e)}))},e.state={enableUpload:!1,collection:""},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,r=e.form.getFieldDecorator;I(this.props.collections);var o=Object.values(this.props.collections);return i.a.createElement(ve.a,{visible:t,title:"Upload New Photos",okText:"Upload",onCancel:a,onOk:n},i.a.createElement(ce.a,{layout:"vertical"},i.a.createElement(ce.a.Item,{label:"Choose collection",hasFeedback:!0},r("select",{rules:[{required:!0,message:"Please select the collection to upload photos to!"}]})(i.a.createElement(le.a,{treeData:o,placeholder:"Select Collection",onChange:this.enableUpload}))),i.a.createElement(ce.a.Item,null,r("photos",{valuePropName:"fileList",getValueFromEvent:this.normFile})(i.a.createElement(Ue.a.Dragger,{name:"files",customRequest:this.customRequest,action:w.baseUrl+"/collection/uploadFile",multiple:!0,listType:"picture",disabled:!this.state.enableUpload},i.a.createElement("p",{className:"ant-upload-drag-icon"},i.a.createElement($.a,{type:"inbox"})),i.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload "),i.a.createElement("p",{className:"ant-upload-hint"},"Support for a single or bulk upload."))))))}}]),a}(i.a.Component)),Le=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleCancel=function(){e.props.dispatch(V.hideUpload())},e.handleCreate=function(){var t=e.formRef.props.form;t.validateFields((function(a,n){a||(console.log("Received values of form: ",n),t.resetFields(),e.props.dispatch(M.upload({album:n.select,photos:n.photos.map((function(e){return e.name}))})),e.props.dispatch(V.hideUpload()))}))},e.saveFormRef=function(t){e.formRef=t},e}return Object(r.a)(a,[{key:"render",value:function(){return i.a.createElement(xe,{wrappedComponentRef:this.saveFormRef,visible:this.props.uploadModalVisable,onCancel:this.handleCancel,onCreate:this.handleCreate,collections:this.props.collections})}}]),a}(i.a.Component),Ne=Object(d.b)((function(e){return{uploadModalVisable:e.GalleryReducer.uploadModalVisable,collections:e.CollectionsReducer.collections}}))(Le),_e=a(192),Me=a(265),Ge=a(266);function Ve(){var e=Object(Me.a)(["\n  display: block;\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n  // Add a smooth animation on loading\n  @keyframes loaded {\n    0% {\n      opacity: 0.1;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  // I use utilitary classes instead of props to avoid style regenerating\n  &.loaded:not(.has-error) {\n    animation: loaded 300ms ease-in-out;\n  }\n  &.has-error {\n    // fallback to placeholder image on error\n    content: url(",");\n  }\n"]);return Ve=function(){return e},e}var He,Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkqAcAAIUAgUW0RjgAAAAASUVORK5CYII=",Ye=Ge.a.img(Ve(),Be),ze=function(e){var t=e.src,a=e.alt,n=Object(c.useState)(Be),r=Object(_e.a)(n,2),o=r[0],l=r[1],s=Object(c.useState)(),u=Object(_e.a)(s,2),m=u[0],d=u[1];return Object(c.useEffect)((function(){var e,a=!1;return m&&o!==t&&(IntersectionObserver?(e=new IntersectionObserver((function(n){n.forEach((function(n){!a&&(n.intersectionRatio>0||n.isIntersecting)&&(l(t),e.unobserve(m))}))}),{threshold:.01,rootMargin:"75%"})).observe(m):l(t)),function(){a=!0,e&&e.unobserve&&e.unobserve(m)}}),[t,o,m]),i.a.createElement(Ye,{ref:d,src:o,alt:a,onLoad:function(e){e.target.classList.add("loaded")},onError:function(e){e.target.classList.add("has-error")}})},Ke=te.a.Content,We=te.a.Sider,qe=te.a.Footer,Je=ee.a.SubMenu,Ze=X.a.DirectoryTree,Qe=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this))._handleKeyDown=function(t){switch(t.keyCode){case 27:e.setState({selectedPhoto:{},selectedElements:[]})}},e.selectPhoto=function(t,a){t.stopPropagation(),e.setState({selectedPhoto:e.props.photos.findIndex((function(e){return e.id===a.id})),selectedElements:[e.props.photos.findIndex((function(e){return e.id===a.id}))]})},e.clearSelection=function(){console.log("Clear Selected"),e.setState({selectedPhoto:{}})},e.onCollapse=function(t){console.log(t),e.setState({collapsed:t})},e.handleSelection=function(t){e.setState({selectedElements:t})},e.getStyle=function(t){return void 0!==e.state.selectedElements.map((function(t){return e.props.photos[t]})).find((function(e){return e.id===t}))?{border:"3px solid #2185d0",margin:0,textAlign:"center"}:{textAlign:"center"}},e.handleSizeChange=function(t){e.props.dispatch(V.changeImageSize(t.target.value))},e.addElementRef=function(t){var a=e.state.elRefs;a.push(t),e.setState({elRefs:a})},e.search=function(t){e.setState({filter:t.target.value})},e.onTreeSelect=function(e,t){console.log("selected",t)},e.filterPhotos=function(t){switch(t.key){case"all":case"add":case"upload":e.setState({filter:"",uploaded_filter:""});break;case"uploaded":e.setState({filter:"",uploaded_filter:e.props.uploadDates.sort().reverse()[0]});break;default:if(void 0!==t.key)e.setState({filter:t.key,uploaded_filter:""});else{var a=D(e.props.collections,t[0]);e.setState({filter:a.id,uploaded_filter:""})}}},e.state={ref:null,elRefs:[],selectedElements:[],collapsed:!0,selectedPhoto:{},filter:"",uploaded_filter:""},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.props.dispatch(L.getAll()),this.props.dispatch(M.getAll()),document.addEventListener("keydown",this._handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this._handleKeyDown)}},{key:"renderSelection",value:function(){return this.state.ref&&this.state.elRefs?i.a.createElement(ne.a,{target:this.state.ref,elements:this.state.elRefs,onSelectionChange:this.handleSelection,style:this.props.style}):null}},{key:"render",value:function(){var e=this,t=this.state.selectedElements.map((function(t){return e.props.photos[t]})),a=this.state.filter.toLowerCase();I(this.props.collections);var n=Object.values(this.props.collections),r=this.props.photos.filter((function(t){return function(e,t,a){if(""!==t)return oe()(e.meta.DateAdded,"YYYY-MM-DD'T'HH:mm:SSZ").format("YYYY-MM-DD HH:mm")===t;if(e.name.toLowerCase().includes(a))return!0;if(e.album.toLowerCase()===a)return!0;if(e.exif.DateTaken.toLowerCase().includes(a))return!0;return!1}(t,e.state.uploaded_filter,a)}));var o=r.length+" photos";return this.state.selectedElements.length>0&&(o=this.state.selectedElements.length+" out of "+r.length+" selected"),i.a.createElement(te.a,{style:{minHeight:"100vh"}},i.a.createElement(Te,{search:this.filterPhotos}),i.a.createElement(te.a,null,i.a.createElement(We,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse,style:{overflowY:"auto"}},i.a.createElement(ee.a,{theme:"dark",mode:"inline",selectable:!0,defaultSelectedKeys:["all"],onSelect:this.filterPhotos},i.a.createElement(ee.a.Item,{key:"all"},i.a.createElement($.a,{type:"picture"}),i.a.createElement("span",null,"All Content")),i.a.createElement(ee.a.Item,{key:"uploaded"},i.a.createElement($.a,{type:"clock-circle"}),i.a.createElement("span",null,"Last Uploaded")),i.a.createElement(Je,{key:"calendar",title:i.a.createElement("span",null,i.a.createElement($.a,{type:"calendar"}),i.a.createElement("span",null,"Date Captured"))},this.props.dates.map((function(e,t){return i.a.createElement(ee.a.Item,{key:e},(a=e,oe()(a,"YYYY-MM-DD").format("DD-MM-YYYY")));var a}))),i.a.createElement(Je,{key:"collections",title:i.a.createElement("span",null,i.a.createElement($.a,{type:"camera"}),i.a.createElement("span",null,"Collections"))},i.a.createElement(Ze,{className:"draggable-tree",defaultExpandedKeys:this.state.expandedKeys,draggable:!0,blockNode:!0,onSelect:this.onTreeSelect(),treeData:n}))),i.a.createElement(Fe,null),i.a.createElement(Ne,null),i.a.createElement(ee.a,{theme:"dark",mode:"inline",selectable:!1},i.a.createElement(ee.a.Item,{onClick:function(){return e.props.dispatch(V.showAdd())},key:"add",style:{backgroundColor:"@popover-background",position:"absolute",bottom:50}},i.a.createElement($.a,{type:"plus"})," ",i.a.createElement("span",null,"Add Collection")),i.a.createElement(ee.a.Item,{onClick:function(){return e.props.dispatch(V.showUpload())},key:"upload",style:{backgroundColor:"@popover-background",position:"absolute",bottom:100}},i.a.createElement($.a,{type:"upload"})," ",i.a.createElement("span",null,"Upload")))),i.a.createElement(te.a,null,i.a.createElement("div",{ref:function(t){e.setState({ref:t})},className:"item-container",onClick:this.clearSelection},i.a.createElement(Ke,{style:{padding:28,margin:0,height:"calc( 100vh - 106px)",overflow:"auto"}},i.a.createElement(Z.a,{gutter:[16,16]},r.map((function(t,a){return i.a.createElement(Q.a,{key:t.id,span:parseInt(e.props.imageSize),style:{padding:2}},i.a.createElement("div",{ref:e.addElementRef,className:"item"},i.a.createElement("figure",{className:"galleryImg",style:e.getStyle(t.id),onClick:function(a){return e.selectPhoto(a,t)}},i.a.createElement(ze,{src:w.imageUrl+t.id+"?size=tiny&token="+localStorage.getItem("token"),width:"100%",height:"100%",alt:"thumbnail"}))))})),this.renderSelection()))),i.a.createElement(qe,{style:{backgroundColor:"#141414",height:42,border:"1px solid black",padding:4,zIndex:2,borderBottom:"0px",textAlign:"center"}},this.state.selectedElements.length>0&&i.a.createElement(Se,{selectedPhotos:t}),i.a.createElement("span",{style:{lineHeight:"32px"}}," ",o),i.a.createElement(J.a.Group,{onChange:this.handleSizeChange,style:{float:"right"},defaultValue:this.props.imageSize},i.a.createElement(J.a.Button,{value:"1"},"tiny"),i.a.createElement(J.a.Button,{value:"4"},"Small"),i.a.createElement(J.a.Button,{value:"6"},"Medium"),i.a.createElement(J.a.Button,{value:"8"},"Large")))),i.a.createElement(ge,{data:this.props.photos[this.state.selectedPhoto]})))}}]),a}(i.a.PureComponent),$e=Object(d.b)((function(e){var t=e.PhotoReducer.photos,a=e.CollectionsReducer.dates,n=e.CollectionsReducer.uploadDates;return{photos:t,dates:a,collections:e.CollectionsReducer.collections,uploadDates:n,imageSize:e.GalleryReducer.imageSize}}))(Qe),Xe=(a(246),a(89)),et=(a(507),a(273)),tt=(a(509),ce.a.create({name:"form_in_modal"})(function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).handleSubmit=function(t){t.preventDefault(),e.props.form.validateFields((function(t,a){t||(console.log("Received values of form: ",a),a.username&&a.password&&(console.log("sending: ",a),e.props.onDone(a)))}))},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(ce.a,{onSubmit:this.handleSubmit,className:"login-form"},i.a.createElement(ce.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(i.a.createElement(se.a,{prefix:i.a.createElement($.a,{type:"user",style:{color:"rgba(255,255,255,.25)"}}),placeholder:"Username"}))),i.a.createElement(ce.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(i.a.createElement(se.a,{prefix:i.a.createElement($.a,{type:"lock",style:{color:"rgba(255,255,255,.25)"}}),type:"password",placeholder:"Password"}))),this.props.loginFailed&&i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(et.a,{message:"Login Error: Invalid username/password",type:"error",showIcon:!0,closable:!0,style:{backgroundColor:"#141414",textAlign:"left"}}),i.a.createElement("br",null)),i.a.createElement(ce.a.Item,null,i.a.createElement(be.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}}]),a}(i.a.Component))),at=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={redirectToReferrer:!1},e.changeRoute=function(t){console.log("Stopping Reater"),e.props.dispatch(F.login(t.username,t.password))},e}return Object(r.a)(a,[{key:"render",value:function(){return i.a.createElement(Z.a,{type:"flex",justify:"center",align:"middle",style:{minHeight:"100vh"}},i.a.createElement(Q.a,null,i.a.createElement(Xe.a,{title:"GoGallery Dashbard",style:{textAlign:"center"}},i.a.createElement(tt,{login:this.props.login,loginFailed:this.props.loginFailed,onDone:this.changeRoute}))))}}]),a}(i.a.Component),nt=Object(A.f)(Object(d.b)((function(e){console.log(e);var t=e.UserReducer;return{loggingIn:t.loggingIn,loginFailed:t.loginFailed}}))(at)),rt=(a(510),a(153)),ot=a(141),lt=(a(139),a(51)),st=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={confirmDirty:!1,autoCompleteResult:[],auth:{username:""}},e.handleSubmit=function(t){t.preventDefault(),e.props.form.validateFieldsAndScroll((function(t,a){t||(console.log("Received values of form: ",a),void 0!==a.password?e.props.dispatch(F.update({username:a.username,email:a.email,password:a.password})):e.props.dispatch(F.update({username:a.username,email:a.email})))}))},e.handleConfirmBlur=function(t){var a=t.target.value;e.setState({confirmDirty:e.state.confirmDirty||!!a})},e.compareToFirstPassword=function(t,a,n){var r=e.props.form;r.validateFields(["password"],{force:!0}),a&&a!==r.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},e.validateToNextPassword=function(t,a,n){var r=e.props.form;a&&e.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),a&&a!==r.getFieldValue("confirm")?n("Two passwords that you enter is inconsistent!"):n()},e.handleWebsiteChange=function(t){var a;a=t?[".com",".org",".net"].map((function(e){return"".concat(t).concat(e)})):[],e.setState({autoCompleteResult:a})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={wrapperCol:{xs:{span:24,offset:0},sm:{span:8,offset:8}}};return console.log("REGISTRATION STATWE",this.props),i.a.createElement("div",null,i.a.createElement(ce.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},{onSubmit:this.handleSubmit}),i.a.createElement(lt.a,null,this.state.auth.username),i.a.createElement(ce.a.Item,{label:"Username"},e("username",{rules:[{required:!0,message:"Please input your username"}]})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"E-mail"},e("email",{rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Password",hasFeedback:!0},e("password",{rules:[{required:!1,message:"Please input your password!"},{validator:this.validateToNextPassword}]})(i.a.createElement(se.a.Password,null))),i.a.createElement(ce.a.Item,{label:"Confirm Password",hasFeedback:!0},e("confirm",{rules:[{required:!1,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(i.a.createElement(se.a.Password,{onBlur:this.handleConfirmBlur}))),i.a.createElement(lt.a,null),i.a.createElement(ce.a.Item,t,i.a.createElement(be.a,{type:"primary",htmlType:"submit",style:{width:"100%"}},"Save"))))}}]),a}(i.a.Component),ct=Object(d.b)((function(e){return console.log("REG",e.UserReducer),{auth:e.UserReducer,photos:e.PhotoReducer.photos}}))(ce.a.create({name:"register",mapPropsToFields:function(e){return{username:ce.a.createFormField(Object(f.a)({},e.username,{value:e.auth.username})),email:ce.a.createFormField(Object(f.a)({},e.email,{value:e.auth.email}))}}})(st)),it=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={confirmDirty:!1,autoCompleteResult:[],auth:{username:""}},e.handleSubmit=function(t){t.preventDefault(),e.props.form.validateFieldsAndScroll((function(t,a){t||(console.log("Received values of form: ",a),e.props.dispatch(H.setProfile(a)))}))},e.handleConfirmBlur=function(t){var a=t.target.value;e.setState({confirmDirty:e.state.confirmDirty||!!a})},e.compareToFirstPassword=function(t,a,n){var r=e.props.form;r.validateFields(["password"],{force:!0}),a&&a!==r.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},e.validateToNextPassword=function(t,a,n){var r=e.props.form;a&&e.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),a&&a!==r.getFieldValue("confirm")?n("Two passwords that you enter is inconsistent!"):n()},e.handleWebsiteChange=function(t){var a;a=t?[".com",".org",".net"].map((function(e){return"".concat(t).concat(e)})):[],e.setState({autoCompleteResult:a})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={wrapperCol:{xs:{span:24,offset:0},sm:{span:8,offset:8}}};return console.log("REGISTRATION STATWE",this.props),i.a.createElement("div",null,i.a.createElement(ce.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},{onSubmit:this.handleSubmit}),i.a.createElement(lt.a,null,"About"),i.a.createElement(ce.a.Item,{label:"Profile Photo"},e("ProfilePhoto",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Background About Photo"},e("BackgroundPhoto",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Description"},e("Description",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Footer Text"},e("Footer",{})(i.a.createElement(se.a,null))),i.a.createElement(lt.a,null,"Social"),i.a.createElement("p",{style:{textAlign:"center"}},"Leave black to disable"),i.a.createElement(ce.a.Item,{label:"Twitter"},e("Twitter",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Instagram"},e("Instagram",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Website"},e("Website",{})(i.a.createElement(se.a,null))),i.a.createElement(lt.a,null),i.a.createElement(ce.a.Item,t,i.a.createElement(be.a,{type:"primary",htmlType:"submit",style:{width:"100%"}},"Save"))))}}]),a}(i.a.Component),ut=Object(d.b)((function(e){return console.log("SETTINGS:",e.SettingsReducer),{settings:e.SettingsReducer.profile}}))(ce.a.create({name:"register",mapPropsToFields:function(e){return{ProfilePhoto:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.ProfilePhoto})),BackgroundPhoto:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.BackgroundPhoto})),Description:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Description})),Footer:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Footer})),Twitter:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Twitter})),Instagram:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Instagram})),Website:ce.a.createFormField(Object(f.a)({},e.email,{value:e.settings.Website}))}}})(it)),mt=(a(513),a(271)),dt=(a(169),a(103)),pt=(a(515),a(193)),ht=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).handleClose=function(e){var t=r.state.tags.filter((function(t){return t!==e}));console.log("CLOS TAG",t),r.setState({tags:t,removedTags:r.state.removedTags.concat(e)}),r.props.onChange(t)},r.showInput=function(){r.setState({inputVisible:!0},(function(){return r.input.focus()}))},r.handleInputChange=function(e){r.setState({inputValue:e.target.value})},r.handleInputConfirm=function(){var e=r.state.inputValue,t=r.state.tags;e&&-1===t.indexOf(e)&&(t=[].concat(Object(_.a)(t),[e])),r.setState({tags:t,inputVisible:!1,inputValue:""}),console.log("Received values of form",t,r.state),r.props.onChange(t)},r.saveInputRef=function(e){return r.input=e},r.state={tags:[],removedTags:[],inputVisible:!1,inputValue:""},r}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.tags,n=t.inputVisible,r=t.inputValue;return i.a.createElement("div",null,a.map((function(t,a){var n=t.length>20,r=i.a.createElement(pt.a,{key:t,closable:!0,onClose:function(){return e.handleClose(t)}},n?"".concat(t.slice(0,20),"..."):t);return n?i.a.createElement(dt.a,{title:t,key:t},r):r})),n&&i.a.createElement(se.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:78},value:r,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!n&&i.a.createElement(pt.a,{onClick:this.showInput,style:{background:"#141414",borderStyle:"dashed"}},i.a.createElement($.a,{type:"plus"})," New Tag"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(void 0===e.value||null===e.value)return null;var a=e.value.filter((function(e){return!t.removedTags.includes(e)}));return console.log("NEW PROPS",e.value,t.removedTags,a),{tags:a}}}]),a}(i.a.Component),ft=ie.a.Option,gt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={confirmDirty:!1,autoCompleteResult:[]},e.handleSubmit=function(t){t.preventDefault(),e.props.form.validateFieldsAndScroll((function(t,a){t||(console.log("Received values of form: ",a),e.props.dispatch(H.setGallery(a)))}))},e.handleConfirmBlur=function(t){var a=t.target.value;e.setState({confirmDirty:e.state.confirmDirty||!!a})},e.compareToFirstPassword=function(t,a,n){var r=e.props.form;a&&a!==r.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},e.validateToNextPassword=function(t,a,n){var r=e.props.form;a&&e.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),n()},e.handleWebsiteChange=function(t){var a;a=t?[".com",".org",".net"].map((function(e){return"".concat(t).concat(e)})):[],e.setState({autoCompleteResult:a})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={wrapperCol:{xs:{span:24,offset:0},sm:{span:19,offset:5}}};return i.a.createElement(ce.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},{onSubmit:this.handleSubmit}),i.a.createElement(ce.a.Item,{label:"Gallery Name"},e("Name",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Gallery Url"},e("Url",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Images Per Page"},e("ImagesPerPage",{})(i.a.createElement(mt.a,{min:1,max:100,style:{width:"100%"}}))),i.a.createElement(ce.a.Item,{label:"Image Folder"},e("Basepath",{})(i.a.createElement(se.a,null))),i.a.createElement(ce.a.Item,{label:"Image Blacklist"},e("PictureBlacklist",{})(i.a.createElement(ht,null))),i.a.createElement(ce.a.Item,{label:"Collection Blacklist"},e("AlbumBlacklist",{})(i.a.createElement(ht,null))),i.a.createElement(ce.a.Item,{label:"Renderer"},e("Renderer",{})(i.a.createElement(ie.a,null,i.a.createElement(ft,{value:"imagemagick"},"Imagemagick"),i.a.createElement(ft,{value:"navive"},"Native")))),i.a.createElement(lt.a,null),i.a.createElement(ce.a.Item,t,i.a.createElement(be.a,{type:"primary",htmlType:"submit",style:{width:"100%"}},"Save")))}}]),a}(i.a.Component),bt=Object(d.b)((function(e){return console.log("SETTINGS:",e.SettingsReducer),{settings:e.SettingsReducer.gallery}}))(ce.a.create({name:"settings",mapPropsToFields:function(e){return{Name:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Name})),Basepath:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Basepath})),Url:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.Url})),ImagesPerPage:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.ImagesPerPage})),PictureBlacklist:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.PictureBlacklist||[]})),AlbumBlacklist:ce.a.createFormField(Object(f.a)({},e.username,{value:e.settings.AlbumBlacklist||[]})),Renderer:ce.a.createFormField(Object(f.a)({},e.email,{value:e.settings.Renderer}))}}})(gt)),vt=(a(517),a(190)),Et=a(117),yt=ve.a.confirm,Ct=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={fileList:[]},e.showResacanConfirm=function(){var t=Object(Et.a)(e);yt({title:"Are you sure you want to run the rescan task?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){t.props.dispatch(K.purge())},onCancel:function(){console.log("Cancel")}})},e.showClearConfirm=function(){var t=Object(Et.a)(e);yt({title:"Are you sure you want to run the clear task?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){t.props.dispatch(K.clear())},onCancel:function(){console.log("Cancel")}})},e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props.dispatch,t=this,a={name:"file",action:w.baseUrl+"/tasks/upload",headers:{Authorization:localStorage.getItem("token")},className:"maintenance",onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(vt.a.success("".concat(e.file.name," file uploaded successfully")),e.fileList=[]):"error"===e.file.status&&vt.a.error("".concat(e.file.name," file upload failed."));var a=Object(_.a)(e.fileList);a=(a=a.slice(-2)).map((function(e){return e.response&&(e.url=e.response.url),e})),t.setState({fileList:a})}};return i.a.createElement(Z.a,{gutter:[16,16]},i.a.createElement(Q.a,{span:12},i.a.createElement(be.a,{type:"default",icon:"sync",size:"large",style:{width:"100%"},onClick:this.showResacanConfirm}," Resacan image folder ")),i.a.createElement(Q.a,{span:12},i.a.createElement(be.a,{type:"default",icon:"delete",size:"large",style:{width:"100%"},onClick:this.showClearConfirm}," Clear cache "),i.a.createElement("br",null)),i.a.createElement(Q.a,{span:12},i.a.createElement(be.a,{type:"default",icon:"download",size:"large",style:{width:"100%"},onClick:function(){return e(K.backup())}}," Backup Database "),i.a.createElement("br",null)),i.a.createElement(Q.a,{span:12},i.a.createElement(Ue.a,Object.assign({},a,{fileList:this.state.fileList}),i.a.createElement(be.a,{type:"default",size:"large",style:{width:"100%"}},i.a.createElement($.a,{type:"upload"})," Restore Database"))))}}]),a}(i.a.Component),Ot=Object(d.b)((function(e){return console.log("SETTINGS:",e.SettingsReducer),{settings:e.SettingsReducer.gallery}}))(Ct),St=X.a.DirectoryTree,kt=ie.a.Option,wt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={confirmDirty:!1,autoCompleteResult:[],auth:{username:""},albumName:"",albumPic:"",albumID:""},e.handleSubmit=function(t){t.preventDefault(),""!==e.state.albumID?e.props.dispatch(M.update({id:e.state.albumID,name:e.state.albumName,profile_image:e.state.albumPic})):q("warning","Please Select album")},e.onTreeSelect=function(t,a){var n=D(e.props.collections,t[0]);e.setState({albumName:n.name,albumPic:n.profile_image,albumID:n.id}),console.log("selected",n)},e.handleConfirmBlur=function(t){var a=t.target.value;e.setState({confirmDirty:e.state.confirmDirty||!!a})},e.compareToFirstPassword=function(t,a,n){var r=e.props.form;r.validateFields(["password"],{force:!0}),a&&a!==r.getFieldValue("password")?n("Two passwords that you enter is inconsistent!"):n()},e.onChange=function(t){e.setState({albumPic:t})},e.updateAlbumName=function(t){e.setState({albumName:t.target.value})},e.validateToNextPassword=function(t,a,n){var r=e.props.form;a&&e.state.confirmDirty&&r.validateFields(["confirm"],{force:!0}),a&&a!==r.getFieldValue("confirm")?n("Two passwords that you enter is inconsistent!"):n()},e.handleWebsiteChange=function(t){var a;a=t?[".com",".org",".net"].map((function(e){return"".concat(t).concat(e)})):[],e.setState({autoCompleteResult:a})},e}return Object(r.a)(a,[{key:"render",value:function(){var e={wrapperCol:{xs:{span:24,offset:0},sm:{span:8,offset:8}}};I(this.props.collections);var t=Object.values(this.props.collections);return i.a.createElement(Z.a,null,i.a.createElement(Q.a,{span:8,style:{overflowY:"auto",maxHeight:"500px"}},i.a.createElement(St,{className:"draggable-tree",defaultExpandedKeys:this.state.expandedKeys,blockNode:!0,onSelect:this.onTreeSelect,treeData:t})),i.a.createElement(Q.a,{span:16,style:{paddingLeft:"30px"}},i.a.createElement(ce.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},{onSubmit:this.handleSubmit}),i.a.createElement(lt.a,null),i.a.createElement(ce.a.Item,{label:"Album Name"},i.a.createElement(se.a,{value:this.state.albumName,name:"albumName",onChange:this.updateAlbumName})),i.a.createElement(ce.a.Item,{label:"Album Image id"},i.a.createElement(ie.a,{showSearch:!0,placeholder:"Select a photo",optionFilterProp:"children",onChange:this.onChange,value:this.state.albumPic,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},this.props.photos.map((function(e,t){return i.a.createElement(kt,{key:e.id},e.name)})))),i.a.createElement(lt.a,null),i.a.createElement(ce.a.Item,e,i.a.createElement(be.a,{type:"primary",htmlType:"submit",style:{width:"100%"}},"Update")))))}}]),a}(i.a.Component),jt=Object(d.b)((function(e){console.log("REG",e.UserReducer);var t=e.UserReducer,a=e.PhotoReducer.photos;return{auth:t,collections:e.CollectionsReducer.collections,photos:a}}))(ce.a.create({name:"register",mapPropsToFields:function(e){return{username:ce.a.createFormField(Object(f.a)({},e.username,{value:e.auth.username})),email:ce.a.createFormField(Object(f.a)({},e.email,{value:e.auth.email}))}}})(wt)),It=te.a.Content,Dt=[{key:"user",tab:i.a.createElement("span",null,i.a.createElement($.a,{style:{"margin-right":"5px"},type:"user"})," User Settings")},{key:"profile",tab:i.a.createElement("span",null,i.a.createElement($.a,{style:{"margin-right":"5px"},type:"profile"})," Profile Settings")},{key:"settings",tab:i.a.createElement("span",null,i.a.createElement($.a,{style:{"margin-right":"5px"},type:"setting"}),"Site Settings")},{key:"album",tab:i.a.createElement("span",null,i.a.createElement($.a,{style:{"margin-right":"5px"},type:"folder-open"}),"Album Settings")},{key:"maintenance",tab:i.a.createElement("span",null,i.a.createElement($.a,{style:{"margin-right":"5px"},type:"tool"})," Maintenance")}],At={user:i.a.createElement(ct,null),profile:i.a.createElement(ut,null),settings:i.a.createElement(bt,null),album:i.a.createElement(jt,null),maintenance:i.a.createElement(Ot,null)},Tt=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(n.a)(this,a),(e=t.call(this)).onTabChange=function(t,a){console.log(t,a),e.setState(Object(ot.a)({},a,t))},e.state={key:"tab1",noTitleKey:"settings"},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.props.dispatch(H.all())}},{key:"render",value:function(){var e=this;return console.log("STATS",this.props.stats),i.a.createElement(te.a,{style:{minHeight:"100vh"}},i.a.createElement(Te,null),i.a.createElement(te.a,null,i.a.createElement(It,{style:{padding:"50px"}},i.a.createElement(Z.a,{gutter:16},i.a.createElement(Q.a,{span:8},i.a.createElement(Xe.a,null,i.a.createElement(rt.a,{value:this.props.stats.Photos,precision:2,valueStyle:{textAlign:"center"},prefix:i.a.createElement($.a,{style:{"margin-right":"5px"},type:"picture"})}))),i.a.createElement(Q.a,{span:8},i.a.createElement(Xe.a,null,i.a.createElement(rt.a,{value:this.props.stats.Albums,precision:2,valueStyle:{textAlign:"center"},prefix:i.a.createElement($.a,{style:{"margin-right":"5px"},type:"folder-open"})}))),i.a.createElement(Q.a,{span:8},i.a.createElement(Xe.a,null,i.a.createElement(rt.a,{value:this.props.stats.Rubish,precision:2,valueStyle:{textAlign:"center"},prefix:i.a.createElement($.a,{style:{"margin-right":"5px"},type:"delete"})})))),i.a.createElement(Xe.a,{style:{width:"100%",marginTop:"20px"},tabList:Dt,activeTabKey:this.state.noTitleKey,bodyStyle:{backgroundColor:"#000"},onTabChange:function(t){e.onTabChange(t,"noTitleKey")}},At[this.state.noTitleKey]))))}}]),a}(i.a.PureComponent),Pt=Object(d.b)((function(e){var t=e.PhotoReducer.photos,a=e.CollectionsReducer.dates,n=e.CollectionsReducer.uploadDates,r=e.CollectionsReducer.collections;return{stats:e.SettingsReducer.stats,photos:t,dates:a,collections:r,uploadDates:n}}))(Tt),Rt=function(e){var t=e.component,a=Object(s.a)(e,["component"]);return i.a.createElement(A.b,Object.assign({},a,{render:function(e){return localStorage.getItem("token")?i.a.createElement(t,e):i.a.createElement(A.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},Ft=function(e){e.location;return i.a.createElement(A.a,{to:"/"})},Ut=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={timer:null,counter:0},e.tick=function(){localStorage.getItem("token")&&e.props.dispatch(F.reauth())},e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=setInterval(this.tick,2e4);this.setState({timer:e})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.timer)}},{key:"render",value:function(){return i.a.createElement("main",null,i.a.createElement(A.c,{history:k},i.a.createElement(Rt,{path:"/",component:$e,exact:!0}),i.a.createElement(A.b,{path:"/login",component:nt}),i.a.createElement(Rt,{path:"/settings",component:Pt}),i.a.createElement(A.b,{component:Ft})))}}]),a}(i.a.Component),xt=Object(d.b)((function(e){return{state:e}}))(Ut);m.a.render(i.a.createElement(d.a,{store:Object(p.d)(y,He,Object(p.a)(C.a,j))},i.a.createElement(xt,null)),document.getElementById("app_root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[278,1,2]]]);
//# sourceMappingURL=main.b765ba06.chunk.js.map